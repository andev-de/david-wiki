<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta HTTP-EQUIV="imagetoolbar" CONTENT="no">
<meta http-equiv="Page-Exit" content="BlendTrans(Duration=0, Transition=0)" />
<!-- 95bb21b86ba9ffc778c3a7c1c52ebc47 -->

<title>Tobit.Software</title>

<script language="javascript" src="https://club.tobit.com/include/alphaAPI.js"></script>
<script language="javascript" src="https://club.tobit.com/include/domLib.js"></script>
<script language="javascript" src="https://club.tobit.com/include/domTT.js"></script>
<script language="javascript" src="https://club.tobit.com/include/domTT_drag.js"></script>

<!-- -->

<script language="javascript" type="text/javascript">
var debug = 0;
</script>
<link  href="/include/imgButtons.css" rel="stylesheet" type="text/css">

<link  href="/include/msgBox.css" rel="stylesheet" type="text/css">
<!--[if lte IE 6]><style type="text/css">td.msgBoxshadow{display:none;}</style><![endif]-->
<script language=javascript src="/include/alert.js"></script>
<script language="javascript">
<!--
function SendToStatusWindow(FormName, width, height)
{
    if (!width)
        width=400;
    if (!height)
        height=200;
           
    var frm;
    var left= (screen.width-width)/2;
    var top = (screen.height-height)/2;
    var settings = " dependent=yes,"+
                   " hotkeys=no," +
                   " menubar=no," +
                   " locationbar=no," +
                   " status=no," +
                   " height=" + height + "," +
                   " width=" + width + "," +
                   " top=" + top + "," +
                   " left=" + left;
    frm = eval("document.forms." + FormName);
    frm.target="StatusWindow";
    //window.open("about:blank", "StatusWindow", settings, true);
    tmp = window.open("/include/EmptyStatusWin.htm", "StatusWindow", settings, true);        
    if (tmp)
      tmp.focus();
    
    return true;
}

function SendURLToStatusWindow(url, width, height)
{
    if (!width)
        width=400;
    if (!height)
        height=200;
           
    var left= (screen.width-width)/2;
    var top = (screen.height-height)/2;
    var settings = " dependent=yes,"+
                   " hotkeys=no," +
                   " menubar=no," +
                   " locationbar=no," +
                   " status=no," +
                   " height=" + height + "," +
                   " width=" + width + "," +
                   " top=" + top + "," +
                   " left=" + left;
    //window.open("about:blank", "StatusWindow", settings, true);
    tmp = window.open(url, "StatusWindow", settings, true);        
    if (tmp)
      tmp.focus();
    
    return true;
}		

//-->
</script>


  <style>
  <!--
  
  A:link {color:#000000; text-decoration: none;  font-weight: normal;}
  A:visited {color:#000000; text-decoration: none;  font-weight: normal;}
  A:active {color:#000000;  text-decoration: none;  font-weight: normal;}
  A:hover {color:#000000;  text-decoration: underline;  font-weight:  normal;}

  .tdDefault {background-color:#e4e4e4; font-family:"ARIAL, HELVETICA, SANS-SERIF"; font-size:8pt; color:#000000}
  .tdNote    {background-color:#f7f7f7; font-family:"ARIAL, HELVETICA, SANS-SERIF"; font-size:8pt; color:#000000}

  -->
  </style>
  <script language=javascript>
  <!--
  function open_Window(val)
  {    
    if(document.all)
    {
      iW=window.parent.top.document.body.offsetWidth;
      iH=window.parent.top.document.body.offsetHeight;
    }
    else
    {
      iW=window.innerWidth;
      iH=window.innerHeight;
    }
  
    iW = (Math.floor((iW/2))-250);
    iH = (Math.floor((iH/2))-150);
  
    var oUrl = "assessment.asp?ArticleID=" + val;
    var Wparam = "width=500,height=310,left="+ iW +",top="+ iH;
    F1 = window.open(oUrl,"Tobit_Software",Wparam);    
  }
  -->
  </script>
   <script language=javascript src="/include/datefunctions.js"></script>
   <script language=javascript src="/include/tobitPages.js?id=1"></script>
   <script language="JavaScript" type="text/javascript">
   function debAlert(msg)
   {
      
   }
   </script>
   <script language="javascript" src="/include/stringfunctions.js"></script>
   <script language=javascript src="/include/textfield.js"></script>
   <script language="javascript" src="/include/jquery_latest.js"></script>
   <script type="text/javascript" src="/include/jquery.modaldialog.js"></script>


   <link href="/include/tobit2009.css" rel="stylesheet" type="text/css" media="screen">
   <link href="/include/tobit2009_print.css" rel="stylesheet" type="text/css" media="print">

   <style type="text/css">
   div.gradient
   {
      position:absolute; top:70px; left:0px; width:100%; z-index:100; background-image:url(/graphic/gradient.png); background-repeat:repeat-x;
   }   
   </style>
   
   <!--[if lte IE 6]>
   <style type="text/css">

   </style>
   <![endif]-->

   <!--[if lte IE 7]>
   <style type="text/css">
   ul.SubMenu a
   {
      padding:1px 10px 1px 10px;
   }
   
   div.gradient
   {
      top:69px;
   }
   
   div#menubar
   {
      height:23px;
   }
   
   </style>
   <![endif]-->

   
   <link rel="alternate" type="application/rss+xml" title="Tobit.NET" href="http://rss.tobit.com/rss.asp" />

   

   </head>

   

   <body class="mainpages"   >

   
         <div id="topshadow">
            
            <div style="position:absolute; right:20px; top:13px; height:20px; width:150px; cursor:pointer;" onclick="location.href='/login/Start.asp';"></div>
         </div>
         
      
      <div id="menubar">
                     
      </div>
      
<script type="text/javascript">
var txtUsername = "Username, Site-ID oder Kartennr.";
var CookiesLoaded=false;
var permanentShow=false
var supressHideLogin = false;
var LoginDialogTimer = null;
   

   function LoginDialogFocusForm(element) 
    {
        clearLoginDialogTimer();
        supressHideLogin = true;
        element.value == txtUsername ? element.value = "" : element.value = element.value;
        //element.value == "Kennwort" ? element.value = "" : element.value = element.value;
    }

    function LoginDialogFocusFormPwd(element, hasFocus) 
    {
        clearLoginDialogTimer();
        if (hasFocus)
            supressHideLogin = true;
        else
            supressHideLogin = false;    
         
        if (element.value == "" && hasFocus ==  false)
           element.style.backgroundImage = "url(/graphic/TextGraphic/PasswordPinGer.png)";
        else 
           element.style.backgroundImage = "";
    }

    function LoginDialogBlurFormPwd(element) 
    {
        supressHideLogin = false;    
        HideLoginDialog();
         
        if (element.value == "")
           element.style.backgroundImage = "url(/graphic/TextGraphic/PasswordPinGer.png)";
        else 
           element.style.backgroundImage = "";
    }
    
    function LoginDialogBlurForm(element) 
    {
        supressHideLogin = false;
        HideLoginDialog();
        (element.value == "" && element.name == "LoginID") ? element.value = txtUsername : element.value = element.value;
        (element.value == "" && element.name == "LoginPwd") ? element.value = "Kennwort" : element.value = element.value;
    }
    
    function LoginDialogAnmelden()
    {
      LoginDialogSetCookie(document.loginform.RememberPassword);
      document.loginform.submit();
    }


   //Cookies
   function LoginDialogReadCookies()
   {
      if (CookiesLoaded)
         return;
         
      CookiesLoaded=true;   
   
      if (!document.loginform || !document.loginform.LoginID)
         return;
         
	   if (navigator.cookieEnabled == true)
	   {
	      var userID = getCookieStr ("AccDataClub");
	      var PassWD = getCookieStr ("PassWDClub");
	      var pwState = getCookieStr ("storePwdClub") == 1;

         if (userID!="")
            document.loginform.LoginID.value = userID;
            
         if (PassWD!="")
         {
            document.loginform.LoginPwd.value = PassWD;
         }
         LoginDialogFocusFormPwd(document.loginform.LoginPwd, false);

         if (pwState)         
         {
            document.getElementById("idRememberPassword").checked = true;
            /*
            Check("div_RememberPassword", "RememberPassword")
            CheckboxHover("div_RememberPassword", true)
            CheckboxHover("div_RememberPassword", false)
            */
            //url= location.href+""
            //if (url.search("logout")==-1)
            if (permanentShow)
               document.loginform.submit();
         }
	   }
   }

   function LoginDialogSetCookie(src)
   {   
      clearLoginDialogTimer();
      if (document.loginform.RememberPassword.checked) 
         LoginDialogUpdateCookie();
      else
         LoginDialogDeleteCookie();
   }

   function LoginDialogUpdateCookie()
   {
	   if (navigator.cookieEnabled)
	   {
	      var userID  = document.loginform.LoginID.value;
	      var PassWD  = document.loginform.LoginPwd.value;
	      var pwState = document.loginform.RememberPassword ? 1 : 0;
         
         setCookie ("AccDataClub", userID, null, null, "/");
         setCookie ("PassWDClub", PassWD, null, null, "/");
         setCookie ("storePwdClub", "1", null, null, "/");
	   }
   }

   function LoginDialogDeleteCookie()
   {
	   if(navigator.cookieEnabled == true)
	   {
         setCookie ("AccDataClub", "", null, null, "/");
         setCookie ("PassWDClub", "", null, null, "/");
         setCookie ("storePwdClub", "0", null, null, "/");
	   }
   }
      
   function ShowLoginDialog (permanent)
   {
      if (permanent)
         permanentShow=permanent;

      if (document.getElementById("MenuPoint10010"))
         document.getElementById("MenuPoint10010").className = "mainmenuhover";
      
      LoginDialogReadCookies();
      //document.getElementById ("SubMenuPoint10010").style.display = "block";
      //document.getElementById ("SubMenuPoint10010").style.left = "1800px";
      document.getElementById ("LoginDialogDIV").style.visibility="visible";
      document.getElementById ("LoginDialogDIV").style.right="10px";

      clearLoginDialogTimer();
   }

   function HideLoginDialog (ev)
   {
      if(!ev)
         ev = window.event;
      
      /*Wegen den tollen selbst designten Radiobuttons*/
      if(ev && ev.srcElement && ev.srcElement.tagName.toLowerCase() == "form")
         return;
      else if(ev && ev.target && (ev.target.tagName.toLowerCase() == "form" || ev.target.tagName.toLowerCase() == "img" || ev.target.tagName.toLowerCase() == "span"))
         return;
         
      if (supressHideLogin)
         return;
      if (!permanentShow)
      {
         LoginDialogTimer = window.setTimeout("HideLoginDialogCallback();", 200);         
      }
   }
   function HideLoginDialogCallback ()
   {
      document.getElementById ("LoginDialogDIV").style.visibility="hidden";
      if (document.getElementById("MenuPoint10010"))
         document.getElementById("MenuPoint10010").className = "";
   }
   
   function clearLoginDialogTimer()
   {
      if (LoginDialogTimer)
         window.clearTimeout(LoginDialogTimer);
      LoginDialogTimer = null;
   }   
   
   function setLogintype(t)
   {
      tn = document.getElementById ("tobitnetlogin");
      fb = document.getElementById ("facebooklogin");
      /*
      if (t=="tobitnet")
      {
         tn.style.display = "block"
         fb.style.display = "none"
      }
      else
      {
         tn.style.display = "none"
         fb.style.display = "block"
      }
      */
   }
   
   function anmelden()
   {
      tn = document.getElementById ("logintype_tobitnet");
      
      if (tn.checked)
      {
         supressHideLogin=true;
         clearLoginDialogTimer();
         LoginDialogSetCookie();
         document.forms.loginform.submit();
      }
      else   
         window.location.href='https://club.tobit.com/login/FacebookConnect.asp'            
   }

   function LoginDialogKeyUp(e)
   {
      keyCode = e.keyCode? e.keyCode : e.charCode;
      if(keyCode == 13)
         anmelden();
   }
</script>

<style>
div.LoginDialogMain
{
   height:178px !important;
   padding-top:20px !important;
}
</style>


<div class="LoginDialogMain" style="visibility:hidden;" id="LoginDialogDIV" onmouseover="clearLoginDialogTimer()">
      <form name="loginform" action="https://club.tobit.com/login.asp" method="post" onsubmit="">
      <input type="hidden" name="logindialog" value="club1"/>
      <input type="hidden" name="LoginFailCount" value="1"/>
      <input type="hidden" name="PublicSite" value="1"/>      
      
      
      
      <input type="radio" name="logintype" onclick="setLogintype('tobitnet');" id="logintype_tobitnet" value="tobitnet" checked>&nbsp;&nbsp;<label for="logintype_tobitnet" onclick="setLogintype('tobitnet');">Tobit.NET login</label> 
      <div id="tobitnetlogin" style="display:block; margin-left:20px; margin-top:10px; margin-bottom:10px;">
      
         <input class="LoginDialog" name="LoginID" style="width:180px;margin-bottom:10px;" type="text" value="Username, Site-ID oder Kartennr." onfocus="LoginDialogFocusForm(this)" onblur="LoginDialogBlurForm(this)" />
         <br />
         <input class="LoginDialog" name="LoginPwd" style="width:180px;margin-bottom:10px; background-repeat:no-repeat; background-position:4px 3px;" type="password" value="" onfocus="LoginDialogFocusFormPwd(this, true)" onblur="LoginDialogBlurFormPwd(this)" onkeyup="LoginDialogKeyUp(event);" />
         <br />
         <input type="checkbox" class="ccheckbox" id="idRememberPassword" name="RememberPassword" onclick="LoginDialogSetCookie(document.loginform.RememberPassword);" />
         &nbsp;<label style="position:relative; top:-2px;" for="idRememberPassword">k&uuml;nftig automatisch anmelden</label>
         
      </div>
      
            
      <input type="radio" name="logintype" onclick="setLogintype('facebook');" id="logintype_facebook" value="facebook">&nbsp;&nbsp;<label for="logintype_facebook" onclick="setLogintype('facebook');">Facebook login</label> 

      <div style="margin-top:15px;"> 
      </div>         
      <link  href="/include/imgButtons.css" rel="stylesheet" type="text/css"><script language=javascript src="/include/CButtons.js"></script><span class=noprint><table width=100% cellpadding=0 cellspacing=0 height=22><tr><td align=right valign=bottom><button type=button onfocus="this.blur();" onmousedown="CButtons_Mouse3(this, true, '/graphic/buttons/completed/tobitDark#status#_70x19.png');" onmouseup="CButtons_Mouse3(this, false, '/graphic/buttons/completed/tobitDark#status#_70x19.png');" onmouseover="CButtons_Hover3(this, true, '/graphic/buttons/completed/tobitDark#status#_70x19.png');" onmouseout="CButtons_Hover3(this, false, '/graphic/buttons/completed/tobitDark#status#_70x19.png');" type="button" class="imgButton3Dark" style=" background-image: url(/graphic/buttons/completed/tobitDark_70x19.png); height:19px; width:70px;" onfocus='clearLoginDialogTimer();' onClick=anmelden();>Anmelden</button>
</td></tr></table></span>
      </form>
</div>
<script language="javascript">
   document.getElementById("LoginDialogDIV").onmouseout = HideLoginDialog;
</script>
      
   <div id="outer" align="center">
   
   
   
     <div id="inner-content" align="center">
       
       <div id="content"> 
       
          <div class="title">Q-107.941</div>
          
<b class=tabletext style="position:relative; top:-5px;">Automation Regeln unter Verwendung von JavaScript</b>

<p style="position:relative; top:-14px;">
<br>
<table cellspacing="0" cellpadding="2" class="border" ID="Table1">
  <tr>
    <td colspan="2" class="borderhead" style="padding-left:5px;"><b>Frage</b></td>
  </tr>
  <tr>
    <td colspan="2" class="tabletext" height="5"></td>
  </tr>
  
    <tr>
      <td width="70" valign="top" align="right" class="tabletext" style="padding-right:10px;"><b>Problem</b></td>
      <td class="tabletext" style="padding-right:10px;">JavaScript soll bei einer Automation Regel berücksichtigt werden.</td>
    </tr>
    
    <tr>
      <td width="70" align="right" class="tabletext" style="padding-right:10px;"><b>Produkt</b></td>
      <td class="tabletext">Automation</td>
    </tr>
    
    <tr>
      <td width="70" align="right" class="tabletext" style="padding-right:10px;"><b>Priorit&auml;t</b></td>
      <td class="tabletext">normal</td>
    </tr>
    
    <tr>
      <td width="70" align="right" class="tabletext" style="padding-right:10px;"><b>Effekt</b></td>
      <td class="tabletext">normal</td>
    </tr>
    
  <tr>
    <td width="70" align="right" class="tabletext" style="padding-right:10px;"><b>Datum</b></td>
    <td class="tabletext">8.06.2006</td>
  </tr>
  <tr>
    <td colspan="2" class="tabletext" height="5"></td>
  </tr>
</table>
</p>

<p>
<table cellpadding="2" cellspacing="0" class="border">
  <tr>
    <td class="borderhead" style="padding-left:5px"><b>Antwort</b></td>
  </tr>
  <tr>
    <td class="tabletext" height="5"></td>
  </tr>
  <tr>
    <td class="tabletext" style="padding-left:10px; padding-right:10px;">Ein ausgeklügeltes Regelwerk und Automation-Scripte bilden die Grundlage einer "mitdenkenden" Umgebung, welche vom DvISE Server gesteuert wird.<p>Mit Regeln und Scripten lassen sich nahezu alle denkbaren Szenarien im Bereich der Automation in die Realität umsetzen. Ganz egal, ob es sich dabei um Beleuchtung, Jalousien, Heizung, Windmessung oder Sonstiges handelt. Alle relevanten Daten zur Automation laufen zentral im State-Archive des DvISE Servers ein, welches im David InfoCenter über »<span style="cursor:hand" onmouseover="return makeTrue (domTT_activate(this, event, 'caption', 'Archive', 'content', 'Der elektronische Ordner im David.InfoCenter nennt sich Archive. Hier k&ouml;nnen alle Nachrichten, Dokumente und multimediale Dateien ganz einfach abgelegt und verwaltet werden.', 'trail', true, 'fade', 'both','closeAction', 'remove') )" onmouseout="return makeTrue (domTT_mouseout(this, event) )" >Archive<img src="/graphic/glossary_s.gif" border=0 align="absmiddle" onclick="return makeFalse (domTT_activate(this, event, 'caption', 'Archive', 'content', 'Der elektronische Ordner im David.InfoCenter nennt sich Archive. Hier k&ouml;nnen alle Nachrichten, Dokumente und multimediale Dateien ganz einfach abgelegt und verwaltet werden.', 'type', 'sticky', 'closeLink', 'close', 'closeAction', 'remove') )"></span> -> System -> DvISE -> Automation -> State« aufrufbar ist.<p>Von hier aus können alle denkbaren Abhängigkeiten in Form von Regeln definiert werden. Durch die offen gestaltete Scriptprogrammierung - basierend auf JavaScript und einigen speziellen DvISE Befehlen - ist diese Art der Programmierung nicht nur eingefleischten Programmierern vorenthalten. Nach einer kurzen Einarbeitungszeit sollte es jedem möglich sein, einfache Scripte individuell zu erstellen und anzupassen. <p><b>Hinweis:</b><br>Einige JavaScript Beispiele befinden sich im David InfoCenter Archive »Archive -> System -> David -> Automation -> Scripte«.<p>Um ein neues Automation Script zu erstellen, gehen Sie wie folgt vor:<ul><li>Wählen Sie im Archive-Baum des David InfoCenter das Verzeichnis »Archive -> System -> DvISE -> Automation -> State« und klicken das Archive mit der rechten Maustaste an und wählen »Regeln...« aus dem Kontextmenü. Es öffnet sich das Dialogfenster »Regeln«.<p><li>Klicken Sie auf die Schaltfläche »Hinzufügen«, um eine neue Regel anzulegen.<p><li>Vergeben Sie einen Namen für die Regel.<p><li>Wählen Sie aus der Liste die Aktion »Ausführen einer Automation«<p><li>Klicken Sie auf »Weiter«. Es öffnet sich das Dialogfenster »Bedingung«, auf dem Sie Kriterien festlegen können.</ul>Egal, welche Aktion Sie durchführen wollen, immer ist die Regel abhängig von einer (oder auch mehreren) Bedingung. Nur wenn diese Bedingung erfüllt ist, kommt die Regel zur Anwendung. Wenn Sie also auf der Registerkarte »Neue Regel« auf »Weiter« klicken, gelangen Sie automatisch auf die Registerkarte »Bedingung«.<ul><li><b>Registerkarte »Bedingung«</b><br>Aus dem ersten Listenfeld wählen Sie durch Mausklick auf den Pfeil eine Option aus, nach der verteilt werden soll. Im nächsten Listenfeld wählen Sie einen der Operatoren »gleich«, »ungleich«, »kleiner« oder »größer«. In das letzte Feld tragen Sie das Verteilkriterium ein.<p>In diesem Feld haben Sie auch die Möglichkeit, so genannte Jokerzeichen (wild cards) zu verwenden. Dadurch können Sie Begriffe einsetzen, die nur zum Teil mit dem Verteilkriterium übereinstimmen.<p>Um weitere Bedingungen einzugeben, klicken Sie auf die Schaltfläche »Bedingung hinzufügen« und füllen erneut die drei Felder aus. Die Zeilen Ihrer Regel sind standardmäßig durch den Operator »oder« verknüpft, d.h., eine Nachricht wird dann verteilt, wenn entweder die erste oder die zweite Bedingung zutrifft. Durch einen Mausklick auf »oder« am Ende der ersten Zeile wechselt der Operator zu »und«. Jetzt müssen beide Bedingungen gleichzeitig zutreffen, damit die Nachricht verteilt wird. Ein Mausklick auf die Schaltfläche »Letzte Bedingung entfernen« löscht die letzte Zeile.<p><b>Beispiel:</b><p><img src="/graphic/kb/D-107.941-01.JPG"><p><li><b>Registerkarte »Aktion«</b><br>Auf dieser Registerkarte legen Sie fest, welche Aktion ausgeführt werden soll, wenn ein unter »Bedingung« festgelegtes Kriterium zutrifft.<p><img src="/graphic/kb/D-107.941-02.JPG"><p><li>Ausführen eines Scripts<br>Aktivieren Sie diesen Schalter, wenn Sie als Aktion ein Script ausführen wollen. Tragen Sie anschließend in das Eingabefeld Pfad und Namen des auszuführenden Scriptes ein oder wählen Sie eins aus, nachdem Sie das nebenstehende Symbol angeklickt haben.<p>Wenn das auszuführende Script noch nicht existiert, klicken Sie auf »Neues Script«, um den Editor aufzurufen. Alternativ kann ein neues Script auch durch Klick auf die Schaltfläche »Neu« im Archive »Archive -> System -> David -> Automation -> Scripte« erstellt werden.<p>Mit der Schaltfläche »Bearbeiten« kann ein bestehendes Script angepasst werden.</ul><b>Erläuterung des Beispiel-Scripts »Feuermelder«</b><p><b>Hinweis:</b><br>Dieses Beispiel-Script befindet sich im Archive »Archive -> System -> David -> Automation -> Scripte« des David InfoCenter.<ul><img src="/graphic/kb/D-107.941-03.JPG"></ul><table><tr><td class=tdNote width=320><b>Befehl</b></td><td class=tdNote><b>Erläuterung</b></td></tr><tr><td class=tdNote>// *************** Beispiel-Script "Feuermelder" *****************<br>// Das Script überprüft, ob die aktuelle Adresse zu einem Feuer-<br>// melder gehört und ob deren Wert 1 beträgt.<br>// Ist das der Fall, wird per SMS ein Warnhinweis versendet,<br>// der zusätzlich die Gruppenadresse des Feuermelders enthält.</td><td class=tdNote>Hierbei handelt es sich um ein Kommentarfeld. Kommentare müssen mit dem JavaScript Befehl »//« beginnen.</td></tr><tr><td class=tdNote>if (m_rxsr.from == "6/1/24" && m_rxsr.value == 1)</td><td class=tdNote>Wenn (»if«) die Bedingung »(m_rxsr.from == "6/1/24" && m_rxsr.value == 1)« zutrifft, werden die innerhalb der beiden geschweiften Klammern (»{« und »}«) aufgeführten Befehle ausgeführt. Falls diese Bedingung nicht zutrifft, werden alle Befehle innerhalb der geschweiften Klammern übersprungen.<p>In diesem Beispiel wird überprüft, ob die Bus-Adresse - welche diese Regel aufgerufen hat (»m_rxsr.from«) - mit der Bus-Adresse »6/1/24« übereinstimmt. Des weiteren wird mit »&&« festgelegt, dass eine zweite Bedingung zutreffen muss: Der Wert der Bus-Adresse - welche diese Regel aufgerufen hat (»m_rxsr.value«) - muss »1« sein.</td></tr><tr><td class=tdNote>{</td><td class=tdNote>Anfang der Befehlskette, wenn die »if«-Bedingung zutrifft.</td></tr><tr><td class=tdNote>var oNumber = "Bitte Handynummer eintragen";</td><td class=tdNote>Tragen Sie hier innerhalb der Anführungszeichen eine beliebige Handynummer ein, um diese der Variablen »var oNumber« zuzuweisen.</td></tr><tr><td class=tdNote>var DvApi = new ActiveXObject("DVOBJAPILib.DvISEApi");</td><td class=tdNote>An dieser Stelle wird über den Aufruf eines ActiveXObjectes ein Zugriff auf ein Archive des DvISE Servers ermöglicht.</td></tr><tr><td class=tdNote>var oAcc = DvApi.Logon();</td><td class=tdNote>Über das zuvor erstellte Objekt »var DvApi = new ActiveXObject("DVOBJAPILib.DvISEApi");« erfolgt eine Anmeldung an den DvISE Server.</td></tr><tr><td class=tdNote>var oArchiveOut = oAcc.GetSpecialArchive("102");</td><td class=tdNote>Hier handelt es sich um einen speziellen DvAPI Befehl, der das Archive »Ausgang« des aktuell angemeldeten Users bzw. ab David V8+ des übergebenen Benutzers auswählt.</td></tr><tr><td class=tdNote>var oNewItem = oArchiveOut.NewItem("2");</td><td class=tdNote>DvAPI Befehl, der besagt, dass eine neue Nachricht im Format »eMail« erstellt werden soll.</td></tr><tr><td class=tdNote>oNewItem.BodyText.PlainText =</td><td class=tdNote>DvAPI-Befehl, der festlegt, dass die neue Nachricht im PlainText- und nicht im HTML-Format erstellt wird.</td></tr><tr><td class=tdNote>oNewItem.Save(oArchiveOut, 2);</td><td class=tdNote>DvAPI-Befehl, der das Objekt in dem oben festgelegten Archive »oArchiveOut« ablegt.</td></tr><tr><td class=tdNote>}</td><td class=tdNote>Ende der Befehlskette.</td></tr></table><p><b>Alternativ-Script anhand des Beispiels »Feuermelder« (ohne DvAPI Zugriff)</b><ul><img src="/graphic/kb/D-107.941-04.JPG"></ul><b>Erläuterung der Alternativ-Befehle</b><br><p><table><tr><td class=tdNote><b>Befehl</b></td><td class=tdNote><b>Erläuterung</b></td></tr><tr><td class=tdNote>var jobText =</td><td class=tdNote>Hierbei handelt es sich um eine JavaScript Variable, welche @@-Befehle enthält. Der Name der Variablen kann frei definiert werden.</td></tr><tr><td class=tdNote>createJob(jobText);</td><td class=tdNote>Spezieller DvISE Befehl, welcher die in der Variablen (»jobText«) hinterlegten @@-Befehle ausführt.</td></tr></table><p><b>Hinweis:</b><br>Ausführliche Informationen zum Thema »DvAPI und Dokumentation« erhalten Sie im<br> <a href="kbarticleCLUB.asp?ArticleID=3080" target="_self"><b>KnowledgeBase Artikel Q-103.080</b></a>. Alle nutzbaren @@-Befehle sind in der David InfoCenter Online-Hilfe zu finden.</td>
  </tr>
  <tr>
    <td class="tabletext" height="5"></td>
  </tr>
</table>
</p>
	
<span class=noprint><table width=100% cellpadding=0 cellspacing=0 height=32><tr><td align=right valign=bottom><button type=button onfocus="this.blur();" onmousedown="CButtons_Mouse3(this, true, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" onmouseup="CButtons_Mouse3(this, false, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" onmouseover="CButtons_Hover3(this, true, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" onmouseout="CButtons_Hover3(this, false, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" type="button" class="imgButton3Dark" style=" background-image: url(/graphic/buttons/completed/tobitDark_72x19.png); height:19px; width:72px;" onClick=open_Window(7941);>Bewertung</button>
&nbsp;<button type=button onfocus="this.blur();" onmousedown="CButtons_Mouse3(this, true, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" onmouseup="CButtons_Mouse3(this, false, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" onmouseover="CButtons_Hover3(this, true, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" onmouseout="CButtons_Hover3(this, false, '/graphic/buttons/completed/tobitDark#status#_72x19.png');" type="button" class="imgButton3Dark" style=" background-image: url(/graphic/buttons/completed/tobitDark_72x19.png); height:19px; width:72px;" onClick=window.history.back();>Zur&uuml;ck</button>
</td></tr></table></span>
<br>

   <script language="javascript">
      PrepareLoginDialog();
         
      function PrepareLoginDialog()
      {
         var phDIV = document.getElementById("MENUPH_LoginDialogDIV")
         var dlgDIV = document.getElementById("LoginDialogDIV")
         if (!phDIV || !dlgDIV)
            return
         
         var dlghtml = dlgDIV.innerHTML;
         if (dlghtml!="")
         {
            dlgDIV.innerHTML="";          
            phDIV.innerHTML=dlghtml;
         }
      }   
    </script>  
   
   </div><!--1-->
   
   </div></div>

  
   </body>

   <script type="text/javascript" src="/include/wndctrl/jquery.checkbox.js"></script>
   <link rel="stylesheet" type="text/css" href="/include/wndctrl/jquery.tobit-checkbox.css" />

   <link rel="Stylesheet" type="text/css" href="/Include/WndCtrl/CCheckbox/CCheckbox.css" />
   <link rel="Stylesheet" type="text/css" href="/Include/WndCtrl/ComboBox/jquery.combobox.css" />
   <script type="text/javascript" src="/Include/WndCtrl/CCheckbox/CCHeckbox.js"></script>
   <script type="text/javascript" src="/Include/WndCtrl/ComboBox/jquery.combobox.js"></script>
   <script language="javascript">
      $(document).ready(function ()
      {
         $('.tobitComboBox').customStyle("");
         $('.tobitComboBoxRed').customStyle("");
         $('input:radio').checkbox({ cls: 'jquery-tobit-radiobtn' });
         $('input:checkbox').checkbox({ cls: 'jquery-tobit-checkbox' });                  
      });
      if (CustomizeForms)
         CustomizeForms()         
   </script>

   </html>
   